- name: Quiz Jinja
  hosts: webservers
  become: true
  vars:
   - nginx_version: 1.23.1-1~jammy

  tasks:
   - name: Adding nginx repository key
     ansible.builtin.apt_key:
       url: "http://nginx.org/keys/nginx_signing.key"

   - name: Adding mariadb repository key
     ansible.builtin.apt_key:
       url: "https://mariadb.org/mariadb_release_signing_key.asc"

   - name: add nginx repository
     template:
       src: nginx.list.j2
       dest: /etc/apt/sources.list.d/nginx.list

   - name: add mariadb repository
     template:
       src: mariadb.list.j2
       dest: /etc/apt/sources.list.d/mariadb.list

   - name: update
     apt:
       update_cache: yes

   - name: install nginx
     apt:
       name: "nginx={{nginx_version}}"
       state: latest

   - name: install mariadb server
     apt:
       name: mariadb-server
       state: latest

   - name: install mariadb client
     apt:
       name: mariadb-client
       state: latest

   - name: restart nginx service
     service: name=nginx state=started enabled=yes

   - name: restart mariadb service
     service: name=mysql state=started enabled=yes
